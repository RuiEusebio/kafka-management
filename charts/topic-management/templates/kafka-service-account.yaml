{{if .Values.kafkaServiceAccount.enabled}}
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: kafkasa
  namespace: confluent
spec:
  encryptedData:
    digest.txt: AgBVg0QgO1S3hGqzM1dtxkjZ6yUC7yA4DyZdgGEFe4XkA93e4o60FLDgZGOPZY5xdtQsl+l44KXvN2oYRac+saekh3OnWbOrizmx88bwGCdLDX8nxr62xNQuDJyqQuU4StLJG5l/e6LXxarHqjnEzaxbiQN1kmYc7wGUpdoaS77wQATwWSgTHdE5r5HANLrqcizY+rCsej4xqLG1ntq7NwvYdg7aw/Cn8ELS+MnlhoU+Bn9/ZYq6EhC/GtSv/mPe8Zs6icI6m7YOcGqoFYH7GIbNy9UXvngpq0xUcj8aBoSgHDmd6yCrmV6lxaLssYxl7a/GIIWRkC1prEE/BDepA4vAFTsHsI8zWn2OFQ3AyQCnzdKLUCeyozg4rYCTLRY8fg2j9KMZgu+ZlmafS5mxf/FkMztcWpsJCFk50sUE21eUYY1uE7fjRpLbTJkmp6M/PYDt0miGvC5TGweKYH1qgTlOqRRN0POAZD1qKZDt89kbqBBHzudVuQ/HBSLL+hrSTa4fmyAd4pqQk7oVDKZPe7i/R/Fr7o/wrr4LWwNjn1DTBi2kvNe0UzUvt6sjmlctCLCjGKI7FBYqpqJiTrm1AS0hmZNdQAdbIkjQh3a9GFe7svt6hHkiaj2MNfTkMNd+mM20dr3R1FdbCiCRHFFGUfcH78UypLzukYSwjSZRwgkpjDdQoMwsQHKk4PM+whvS/D+cTt1g74V4e+2jZmOdIoYR+5ImmOsddJb45Jtajx+SiYCpBdcOS39a
    plain.txt: AgBvOkTKKJ9wl0lqA7lYGqSvrcocvX11gKmTASZOMUNEKie1Q5oOihHkSURjk7p3WRcw/trVvRvWsoC0zJqPSLcJPe4MX78yzHZ+AQNdObcbXQg8GtkxutP6FfOhvl/ng+NBpxIZXAuQqIWGKuJrXkmXFvGHvhxuxaQYAbPkiScOMK2NnKDIa7rQ4TkDBBwBuYC4cyTv1QbWeMlDWDngK6ruY5vTHIAsvPbVuYPyUNbVI/aBa+/oWVHSDXdC6wZf7y+PsHklGzewmCgykhvfQsiVQIwTHKfAxRHGrJSNVyoXiF26dI0a1YtwkAjFjb/Lpe7456w5QJHQ69dd3nrdF/Y8FfwO5PWlQxd/vv1yNAzMLSYS7xiWy5KLf55/SvPQJJ3hqBSx6S+IGZQHCAu2Tz8VdEGpF+wJpRw8qXrR4wTofifbeWrcWpPSr/ayQVBWM1vTfJQmg6YEJVacP1ncnaNcGGll5DQZBlJpkuzyFllEAJ6V8dHPzoP3BQzylxgL78ni9lghldVs5TgNwPeJaNVfzyXDW4jTAGl4Hc0lqZF+l9L3EkRBlkki7MvwrmZm+HHeKuW2xC7e2jRcAvdfklO3MdyM9rPODAl9oCJ7F5I4KERRTcLi8Tw+VDEdcMbEIzPilBRBKE5kdtr7LYf3VQvZnrZPrnqmWgzMvIlxp33nc+a4Tx+XoGgoBvMYxj2G790Vj4dagysebUFzBktbNCykfQUyLQH0LOh20Q/JRVb9zpe5f74=
  {{- range .Values.serviceAccounts }}
    {{ .name }}: {{.secret}}
  {{- end}}
  template:
    metadata:
      name: kafkasa
      namespace: confluent
    data:
      plain-users.json: |
        {    
            {{- $first := true -}}
            {{- range $i :=  .Values.serviceAccounts -}}              
              {{- if $first -}}
                  {{- $first = false -}}
              {{- else -}}
                  ,
              {{- end -}}          
              "{{$i.name }}":{{`"{{- index .`}} "{{$i.name -}}"{{` -`}}{{`}}"`}}
            {{- end -}}
        }
{{ end }}      